{% extends "./user.html" %} {% block body %}



<div class="container py-2">

    {% if transaction.status == 'APPROVED' %}
    <a href="/receipt" class="btn btn-primary">Download Invoice</a>
    {% endif %}

    {% if transaction.status == 'REJECTED' %}
    <button class="btn btn-danger" data-target="#issueModal" data-toggle="modal">
        Create Issue
    </button>

    <div
            aria-hidden="true"
            aria-labelledby="exampleModalLabel"
            class="modal fade"
            id="issueModal"
            role="dialog"
            tabindex="-1"
    >
        <div class="modal-dialog" role="document">
            <div class="modal-content" id="issueContent">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Issue</h5>
                    <button
                            aria-label="Close"
                            class="close"
                            data-dismiss="modal"
                            type="button"
                    >
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form action="/issue" id="issueform" method="POST">
                        <div class="form-group">
                            <label class="form-label">Title</label>
                            <input class="form-control" name="title" type="text" readonly value="Issue regarding transaction with ID {{transaction.id}}"/>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Content</label>
                            <textarea
                                    class="form-control"
                                    cols="30"
                                    name="content"
                                    rows="10"
                            ></textarea>
                        </div>
                        <div class="modal-footer">
                            <a class="btn btn-secondary" data-dismiss="modal">Cancel</a>
                            <button class="btn btn-primary" type="submit">Submit</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    {% endif %}




    <h1>Transaction ID: {{ transaction.id }}</h1>
    <p>Paid by: {{ transaction.getUser().getName() }}</p>
    <p>From Due: {{ transaction.getFromMonth()|date("M Y") }}</p>
    <p>To Due: {{ transaction.getToMonth()|date("M Y") }}</p>
    <p>Status: {{ transaction.status }}</p>
    <h2>Receipts:</h2>
    {% if receipts is not empty %}
    <ul class="list-group">
        <li class="list-group-item">
            {% for receipt in receipts %}
            <img src="/uploads/{{ receipt.getPath() }}" class="img-thumbnail"/>
            {% endfor %}
        </li>
    </ul>
    {% else %}
    <p>No receipts available.</p>
    {% endif %} {% if logs is not empty %}
    <h4>Message</h4>
    <ul class="list-group">
        {% if transaction.status == 'REJECTED' %} {% set bg = 'bg-danger text-white
        p-2' %} {% elseif transaction.status == 'APPROVED' %} {% set bg =
        'bg-success text-white p-2' %} {% else %} {% set bg = 'bg-secondary
        text-white p-2' %} {% endif %} {% for log in logs %}

        <li class="list-group-item">
            <span class="badge badge-pill {{bg}}">{{transaction.status}}</span>
            {{log.message}}
        </li>
        {% endfor %}
    </ul>
    {% endif %}
    <a href="/home" class="btn btn-primary mt-2">Back</a>
</div>

{% endblock %}
